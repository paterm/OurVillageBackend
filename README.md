# MyVillage Backend API

Backend API –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã MyVillage - –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π –∏ —É—Å–ª—É–≥.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º –ø—Ä–æ–µ–∫—Ç (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
git clone <your-repo>
cd MyVillage

# –ö–æ–ø–∏—Ä—É–µ–º env —Ñ–∞–π–ª (—Å–æ–∑–¥–∞–π—Ç–µ .env –Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example)
cp .env.example .env

# –î–∞–µ–º –ø—Ä–∞–≤–∞ —Å–∫—Ä–∏–ø—Ç—É
chmod +x scripts/wait-for-it.sh

# –ó–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up --build
```

## üì° –ü–æ—Ä—Ç—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã:

| –°–µ—Ä–≤–∏—Å | URL/–ê–¥—Ä–µ—Å | –ü–æ—Ä—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----------|------|----------|
| **API Backend** | http://localhost:3001 | 3001 | –û—Å–Ω–æ–≤–Ω–æ–π API —Å–µ—Ä–≤–µ—Ä |
| **Health Check** | http://localhost:3001/health | 3001 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ API –∏ –ë–î |
| **Static Files** | http://localhost:3001/uploads | 3001 | –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) |
| **PgAdmin** | http://localhost:8081 | 8081 | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è PostgreSQL |
| **PostgreSQL** | localhost:5432 | 5432 | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| **Redis** | localhost:6379 | 6379 | –ö—ç—à –∏ —Å–µ—Å—Å–∏–∏ |

### –î–æ—Å—Ç—É–ø –∫ PgAdmin:
- **URL**: http://localhost:8081
- **Email**: admin@ourvillage.com
- **Password**: admin

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –≤ PgAdmin:
- **Host**: db (–≤–Ω—É—Ç—Ä–∏ Docker —Å–µ—Ç–∏) –∏–ª–∏ localhost (—Å–Ω–∞—Ä—É–∂–∏)
- **Port**: 5432
- **Database**: our_village
- **Username**: postgres
- **Password**: password

## üìö API Endpoints

–ë–∞–∑–æ–≤—ã–π URL: `http://localhost:3001`

### Health Check

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|-------|----------|-----------|--------|
| GET | `/health` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ API –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î | Public |

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
{
  "status": "OK",
  "database": "connected",
  "timestamp": "2024-11-23T22:00:00.000Z"
}
```

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/api/auth`)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|-------|----------|-----------|--------|
| POST | `/api/auth/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Public |
| POST | `/api/auth/login` | –í—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Public |
| POST | `/api/auth/logout` | –í—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Private |
| POST | `/api/auth/refresh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞ | Public |
| POST | `/api/auth/verify` | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —á–µ—Ä–µ–∑ SMS | Public |

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:**
```json
POST /api/auth/register
{
  "phone": "+79991234567",
  "password": "password123",
  "name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"
}
```

**–í—Ö–æ–¥:**
```json
POST /api/auth/login
{
  "phone": "+79991234567",
  "password": "password123"
}
```

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`/api/users`)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|-------|----------|-----------|--------|
| GET | `/api/users/profile` | –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Private |
| PUT | `/api/users/profile` | –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Private |
| POST | `/api/users/avatar` | –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Private |
| GET | `/api/users` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–∞–≥–∏–Ω–∞—Ü–∏—è) | Admin |
| GET | `/api/users/:id` | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID | Private |

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**

**–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å:**
```
GET /api/users/profile
Authorization: Bearer <token>
```

**–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å:**
```json
PUT /api/users/profile
Authorization: Bearer <token>
{
  "name": "–ù–æ–≤–æ–µ –∏–º—è",
  "email": "new@email.com"
}
```

**–ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä:**
```
POST /api/users/avatar
Authorization: Bearer <token>
Content-Type: multipart/form-data
Body: file (avatar)
```

### üìã –û–±—ä—è–≤–ª–µ–Ω–∏—è (`/api/listings`)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|-------|----------|-----------|--------|
| POST | `/api/listings` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ | Private/Verified |
| GET | `/api/listings` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ–±—ä—è–≤–ª–µ–Ω–∏–π (—Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏) | Public |
| GET | `/api/listings/my` | –ü–æ–ª—É—á–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Private |
| GET | `/api/listings/:id` | –ü–æ–ª—É—á–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –ø–æ ID | Public |
| PUT | `/api/listings/:id` | –û–±–Ω–æ–≤–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ | Private |
| DELETE | `/api/listings/:id` | –£–¥–∞–ª–∏—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ | Private |

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è GET `/api/listings`:**
- `page` - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1)
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 10)
- `category` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `search` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å
- `minPrice` - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
- `maxPrice` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è:**
```json
POST /api/listings
Authorization: Bearer <token>
Content-Type: multipart/form-data
{
  "title": "–ü—Ä–æ–¥–∞—é –≤–µ–ª–æ—Å–∏–ø–µ–¥",
  "description": "–û—Ç–ª–∏—á–Ω—ã–π –≤–µ–ª–æ—Å–∏–ø–µ–¥ –≤ —Ö–æ—Ä–æ—à–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏",
  "price": 15000,
  "category": "transport",
  "images": [file1, file2, ...]
}
```

### ‚≠ê –û—Ç–∑—ã–≤—ã (`/api/listings`)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|-------|----------|-----------|--------|
| POST | `/api/listings/:listingId/reviews` | –°–æ–∑–¥–∞—Ç—å –æ—Ç–∑—ã–≤ –Ω–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ | Private/Verified |
| GET | `/api/listings/:listingId/reviews` | –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–∑—ã–≤—ã –¥–ª—è –æ–±—ä—è–≤–ª–µ–Ω–∏—è | Public |
| PUT | `/api/listings/reviews/:id` | –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–∑—ã–≤ | Private |
| DELETE | `/api/listings/reviews/:id` | –£–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤ | Private |

**–ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∑—ã–≤–∞:**
```json
POST /api/listings/123e4567-e89b-12d3-a456-426614174000/reviews
Authorization: Bearer <token>
{
  "rating": 5,
  "comment": "–û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–¥–∞–≤–µ—Ü, –≤—Å—ë –±—ã—Å—Ç—Ä–æ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ!"
}
```

### üí¨ –°–æ–æ–±—â–µ–Ω–∏—è (`/api/listings`)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|-------|----------|-----------|--------|
| POST | `/api/listings/:listingId/messages` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—é | Private/Verified |
| GET | `/api/listings/messages/conversations` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Private |
| GET | `/api/listings/messages/conversations/:conversationId` | –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫—É | Private |
| PUT | `/api/listings/messages/conversations/:conversationId/read` | –û—Ç–º–µ—Ç–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ | Private |

**–ü—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:**
```json
POST /api/listings/123e4567-e89b-12d3-a456-426614174000/messages
Authorization: Bearer <token>
{
  "receiverId": "456e7890-e89b-12d3-a456-426614174001",
  "content": "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω –≤ –≤–∞—à–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏–∏"
}
```

### üõ†Ô∏è –£—Å–ª—É–≥–∏ (`/api/services`)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|-------|----------|-----------|--------|
| POST | `/api/services` | –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —É—Å–ª—É–≥—É | Private/Verified |
| GET | `/api/services` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ (—Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏) | Public |
| GET | `/api/services/:id` | –ü–æ–ª—É—á–∏—Ç—å —É—Å–ª—É–≥—É –ø–æ ID | Public |
| PUT | `/api/services/:id` | –û–±–Ω–æ–≤–∏—Ç—å —É—Å–ª—É–≥—É | Private |
| DELETE | `/api/services/:id` | –£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É | Private |

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è GET `/api/services`:**
- `page` - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- `category` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `search` - –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

### üîß –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ (`/api/admin`)

| –ú–µ—Ç–æ–¥ | Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|-------|----------|-----------|--------|
| GET | `/api/admin/stats` | –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã | Admin |
| POST | `/api/admin/listings/:id/moderate` | –ú–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ (approve/reject/ban) | Admin |
| POST | `/api/admin/users/:id/ban` | –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Admin |
| POST | `/api/admin/users/:id/unban` | –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Admin |
| GET | `/api/admin/reports` | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∂–∞–ª–æ–± | Admin |
| POST | `/api/admin/reports/:id/handle` | –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∂–∞–ª–æ–±—É | Admin |

**–ü—Ä–∏–º–µ—Ä –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è:**
```json
POST /api/admin/listings/123e4567-e89b-12d3-a456-426614174000/moderate
Authorization: Bearer <admin_token>
{
  "action": "approve",  // –∏–ª–∏ "reject", "ban"
  "reason": "–û–±—ä—è–≤–ª–µ–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º"
}
```

**–ü—Ä–∏–º–µ—Ä –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```json
POST /api/admin/users/123e4567-e89b-12d3-a456-426614174000/ban
Authorization: Bearer <admin_token>
{
  "reason": "–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã",
  "duration": 30  // –¥–Ω–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ - –Ω–∞–≤—Å–µ–≥–¥–∞)
}
```

## üîí –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ endpoints —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:
```
Authorization: Bearer <your_jwt_token>
```

–¢–æ–∫–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–ª–∏ –≤—Ö–æ–¥–µ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:
- `accessToken` - —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ (–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 15 –º–∏–Ω—É—Ç)
- `refreshToken` - —Ç–æ–∫–µ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 7 –¥–Ω–µ–π)

## üìÅ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

–ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –∞–¥—Ä–µ—Å—É:
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π**: `http://localhost:3001/uploads/listings/<filename>`
- **–ê–≤–∞—Ç–∞—Ä—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: `http://localhost:3001/uploads/avatars/<filename>`

## üóÑÔ∏è –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

### –ú–∏–≥—Ä–∞—Ü–∏–∏:
```bash
# –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
docker-compose exec app npm run db:migrate

# –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
docker-compose exec app npm run db:reset

# –ó–∞–ø–æ–ª–Ω–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
docker-compose exec app npm run db:seed

# –û—Ç–∫—Ä—ã—Ç—å Prisma Studio –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ë–î
docker-compose exec app npm run db:studio
```

### –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î:
```bash
# –ß–µ—Ä–µ–∑ psql –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker-compose exec db psql -U postgres -d our_village

# –ò–ª–∏ —á–µ—Ä–µ–∑ PgAdmin (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
# http://localhost:8080
```

## üõ†Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
docker-compose logs -f app

# –õ–æ–≥–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
docker-compose logs -f db

# –õ–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs -f
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏:
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose down

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–≤–∫–ª—é—á–∞—è volumes)
docker-compose down -v --remove-orphans

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose up --build app

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart app
```

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:
```bash
# –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ app
docker-compose exec app <command>

# –ü—Ä–∏–º–µ—Ä—ã:
docker-compose exec app npm run db:migrate
docker-compose exec app sh
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health check
curl http://localhost:3001/health

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker-compose exec db pg_isready

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis
docker-compose exec redis redis-cli ping

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps
```

## üìù –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
MyVillage/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ controllers/     # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ middleware/      # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ü–û
‚îÇ   ‚îú‚îÄ‚îÄ services/        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ utils/           # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ routes/          # –ú–∞—Ä—à—Ä—É—Ç—ã API
‚îÇ   ‚îî‚îÄ‚îÄ app.js           # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma    # –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ seed.js          # –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ scripts/             # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ uploads/             # –ó–∞–≥—Ä—É–∂–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ .env                 # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ Dockerfile           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
‚îî‚îÄ‚îÄ docker-compose.yml   # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
```

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example` –∏ —É–∫–∞–∂–∏—Ç–µ:

- `DATABASE_URL` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
- `REDIS_URL` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
- `JWT_SECRET` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤
- `SMS_API_KEY` - –∫–ª—é—á API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ SMS
- `AWS_*` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è S3/Object Storage
- `CLIENT_URL` - URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–¥–ª—è CORS)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

[–£–∫–∞–∂–∏—Ç–µ –ª–∏—Ü–µ–Ω–∑–∏—é –ø—Ä–æ–µ–∫—Ç–∞]
